<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>Unsafe Area Mapping</title>
  <link rel="stylesheet" href="./static/lib/css//bootstrap.min.css">
  <link rel="stylesheet" href="./static/lib/css/keen-dashboards.css">
  <link rel="stylesheet" href="./static/lib/css/dc.min.css">
  <link rel="stylesheet" href="./static/lib/css/leaflet.css">
  <link rel="stylesheet" href="./static/css/custom.css">
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.3.0/css/datepicker.css" rel="stylesheet" type="text/css" />

</head>
<body class="application">

  <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <div class="row">
          <!-- <form action="{{ url_for('queryByDate') }}" method="POST"> -->
          <form>
            <div class="col-xs-4">
              <label style="color:white;">Start Date: </label>
              <div id="startdatepicker" class="input-group date" data-date-format="dd-mm-yyyy">
                  <input name="startdatepicker" id="startDate" class="form-control" type="text" />
                  <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
              </div>
            </div>
            <div class="col-xs-4">
              <label style="color:white;">End Date: </label>
              <div id="enddatepicker" class="input-group date" data-date-format="dd-mm-yyyy">
                  <input name="enddatepicker" id="endDate" class="form-control" type="text" />
                  <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
              </div>
            </div>
            <div class="col-xs-4">
              <br>
              <input type="submit" id="submitQuery" value="Submit" class="btn btn-primary" style="margin-top:4px;">
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
<style>
  .navbar-fixed-top {
    color: #FFFFFF;
    background-color: #993399;
}
</style>

  <div class="container-fluid col-sm-3">
    <!-- <div class="row"> -->

      <!-- <div class="col-sm-5">
        <div class="row"> -->

          <!-- Time Chart > 
          <div class="col-sm-12">
            <div class="chart-wrapper">
              <div class="chart-title">
                Daily alarm count
              </div>
              <div class="chart-stage">
                <div id="time-chart"></div>
              </div>
            </div>
          </div>
          < Time Chart --> 

          <!-- deviceCode -->
          <div class="col-sm-12">
            <div class="chart-wrapper">
              <div class="chart-title">
                Device Code
              </div>
              <div class="chart-stage">
                <div id="deviceid-row-chart"></div>
              </div>
            </div>
          </div>
          <!-- deviceCode -->


          <!-- <div class="col-sm-6"> -->

            <!-- alarmType Segment -->
            <!-- <div class="row"> -->
            <div class="col-sm-12">
              <div class="chart-wrapper">
                <div class="chart-title">
                  Complaint severity
                </div>
                <div class="chart-stage">
                  <div id="alarmType-segment-row-chart"></div>
                </div>
              </div>
            </div>
            <!-- alarmType Segment -->

            <!-- day Segment -->
            <div class="col-sm-12">
              <div class="chart-wrapper">
                <div class="chart-title">
                  Day
                </div>
                <div class="chart-stage">
                  <div id="day-row-chart"></div>
                </div>
              </div>
            </div>
            <!-- day Segment -->


            <!-- hour Segment -->
            <!-- <div class="row"> -->
            <div class="col-sm-12">
              <div class="chart-wrapper">
                <div class="chart-title">
                  Hour Segment
                </div>
                <div class="chart-stage">
                  <div id="hour-row-chart"></div>
                </div>
              </div>
            </div>
            <!-- hour Segment -->

          <!-- </div> -->
          </div>


        </div>
      </div>
      </div>

      <!-- <div class="row"> -->
      <div class="col-sm-2">
        <div class="row">
          <div class="col-sm-12">
            <div class="chart-wrapper">
              <div class="chart-title">
                States
              </div>
              <div class="chart-stage">
                <div id="location-state-row-chart"></div>
              </div>
            </div>
          </div>
        </div>
      </div>


      <div class="col-sm-2">
        <div class="row">
          <div class="col-sm-12">
            <div class="chart-wrapper">
              <div class="chart-title">
                Cities
              </div>
              <div class="chart-stage">
                <div id="location-city-row-chart"></div>
              </div>
            </div>
          </div>
        </div>
      </div>



      <div class="col-sm-5">

        <div class="row">
          <!-- Map -->  
          <div class="col-sm-12"> 
            <div class="chart-wrapper">
              <div class="chart-title">
                Map
              </div>
              <div class="chart-stage" id="map_outer">
                <div id="map" style="width: 100%; height: 710px"></div>
              </div>
            </div>
          </div>
          <!-- Map -->  
        </div>

        <div class="row">
          <!-- Number of events -->  
          <div class="col-sm-12"> 
            <div class="chart-wrapper">
              <div class="chart-title">
                Number of Alarms
              </div>
              <div class="chart-stage">
                <div id="number-records-nd"></div>
              </div>
            </div>
          </div>
          <!-- Number of events -->  
        </div>

      </div>

    </div>

  </div>

  <script src="./static/lib/js/jquery.min.js"></script>
  <script src="./static/lib/js/bootstrap.min.js"></script>
  <script src="./static/lib/js/underscore-min.js"></script>
  <script src="./static/lib/js/crossfilter.js"></script>
  <script src="./static/lib/js/d3.min.js"></script>
  <script src="./static/lib/js/dc.min.js"></script>
  <script src="./static/lib/js/queue.js"></script>
  <script src="./static/lib/js/leaflet.js"></script>
  <script src="./static/lib/js/leaflet-heat.js"></script>
  <script src="./static/lib/js/keen.min.js"></script>
  <script src='./static/js/graphs.js' type='text/javascript'></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.3.0/js/bootstrap-datepicker.js"></script>
<script>
    $(function () {
      var startDate = new Date(2018,0,01);
      $("#startdatepicker").datepicker({ 
            autoclose: true, 
            todayHighlight: true
      }).datepicker('update', startDate);
      $("#enddatepicker").datepicker({ 
            autoclose: true, 
            todayHighlight: true
      }).datepicker('update', new Date());
      $("#submitQuery").click(function(e){
        e.preventDefault();
        
        // alert("clicked");
        var startDate = $("#startDate").val();
        var endDate = $("#endDate").val();
        $.ajax({
            type: 'POST',
            url: '/queryByDate',
            dataType: 'json',
            data: { 
                'startDate': startDate, 
                'endDate': endDate
            },
            success: function(msg){
                document.getElementById('map_outer').innerHTML = "<div id='map' style='width: 100%; height: 710px'></div>";
                makeGraphs("",msg);
                console.log(msg);
            }
        });
      });
    });
</script>

</body>
</html>
